<html><head><meta http-equiv="content-type" content="text/html; charset=euc_jp"><meta http-equiv="content-style-type" content="text/css"><link rel="stylesheet" type="text/css" href="default.css"><title>おまかせ!! フォルティア!</title></head><h1><A HREF="index.html" title="おまかせ!! フォルティア! インストールマニュアル" target="_blank">おまかせ!! フォルティア! インストールマニュアル</A></h1><div class="menu"><ol><li><A HREF="foltiastart.html" title="フォルティアとは">フォルティアとは</A><li><A HREF="fcinstall.html" title="Fedora Core 5 インストール">Fedora Core 5 インストール</A><li><A HREF="foltiaivtv.html" title="おまかせ!! フォルティア! ivtvドライバインストール">おまかせ!! フォルティア! ivtvドライバインストール</A><li><A HREF="foltiainstall.html" title="おまかせ!! フォルティア! インストール">おまかせ!! フォルティア! インストール</A></ol></div><div class="main"><h2>おまかせ!! フォルティア! インストール</h2><h3>フォルティアインストール</h3><p></p><h4>必要パッケージのインストールを行う</h4><p>apache「httpd」,PostgreSQL「postgresql」「postgresql-server」「postgresql-devel」, PHP「php」「php-pgsql」のインストールを行う<div class="command"># yum install httpd postgresql postgresql-server postgresql-devel php php-pgsql</div><h4>メディアからフォルティア本体をコピーする</h4><p><div class="command"># su - foltia<br>$ cp /media/cdrom/foltia.tar.gz ~/<br>$ tar zxvf foltia.tar.gz</div></p><h4>httpdの設定を行う</h4><p><div class="command"># vi /etc/httpd/conf/httpd.conf<br><br>　----------------------------------------<br>　User apache<br>　AddDefaultCharset UTF-8<br>　　　↓<br>　User foltia<br>　AddDefaultCharset off<br>　----------------------------------------<br><br># vi /etc/httpd/conf.d/foltia.conf<br><br>　----------------------------------------<br>　Alias /foltia/ "/home/foltia/php/"<br>　 <Directory "/home/foltia/php/"><br><br>　 </Directory><br>　----------------------------------------</div><div class="command"># /etc/init.d/httpd start<br># chkconfig httpd on</div></p><h4>フォルティアデータベースを作成する</h4><p><div class="command"># su - postgres<br>$ initdb --encoding=EUC_JP<br>$ exit<br># /etc/init.d/postgresql start<br># chkconfig postgresql on<br># su - postgres<br>$ createuser --no-adduser --no-createdb --password foltia<br>　Shall the new role be allowed to create more new roles? (y/n) "Enter"<br>　Password:"パスワードを入力する"<br>$ createdb --owner foltia foltia<br>$ exit<br># vi /var/lib/pgsql/data/postgresql.conf<br><br>　---------------------------------------<br>　#listen_addresses = 'localhost'<br>　　↓<br>　listen_addresses = 'localhost'<br>　---------------------------------------<br># /etc/init.d/postgresql restart<br>$ su - foltia<br>$ cd foltia<br>$ psql -f mktable.txt foltia</div></p><h4>perlディレクトリのfoltia_conf1.plの設定を行う</h4><p>環境に合わせて設定してください<div class="command">$ vi /home/foltia/perl/foltia_config1.pl</div></p><h4>phpディレクトリのfoltia_config2.phpの設定を行う</h4><p>環境に合わせて設定してください<div class="command">$ vi /home/foltia/php/foltia_config2.php</div></p><h4>必要なperlモジュールをインストールする</h4><p>初回時の場合は、いろいろ聞かれると思うのでご自分の環境に合わせて設定をしてください<div class="command"># perl -MCPAN -e 'install LWP::Simple'<br># perl -MCPAN -e 'install Jcode'<br># perl -MCPAN -e 'install DBI'<br># perl -MCPAN -e 'install DBD::Pg'<br># perl -MCPAN -e 'install Schedule::At'</div></p><h4>しょぼかるから、番組表をダウンロードする</h4><p>このコマンドを実行する事で、しょぼかるから番組表のダウンロードを行います。終了後は『http://foltia IP/foltia/』にアクセスし、番組表が取得できたことを確認します。<div class="command"># su - foltia<br>$ /home/foltia/perl/getxml2db.pl long</div></p><h4>しょぼかるの番組表をチェックするスケジュールをまわす設定をする</h4><p><div class="command">$ crontab -e<br><br>　-----------------------------------<br>　7 * * * * /home/foltia/perl/schedulecheck.pl > /dev/null 2>&1<br>　-----------------------------------</div></p><h4>EPG録画設定</h4><p>XMLTV日本対応版のインストールを行います。<div class="command">#  yum --enablerepo=atrpms install xmltv xmltv-grabbers kakasi kakasi-devel kakasi-dict<br># su - foltia<br>$ tv_grab_jp --configure<br>　地域ごとの番組設定を行います。<br># tv_grab_jp<br>　実際にEPGが取得できるか確認を行う。<br># perl -MCPAN -e 'install Time::Local'<br># su - foltia<br>$ /home/foltia/perl/cron_foltia_dayly.sh</div></p><h4>EPG番組表をダウンロードするスケジュールをまわす設定をする</h4><p><div class="command">$ crontab -e<br>　-----------------------------------<br>　1 0 * * * /home/foltia/perl/cron_foltia_dayly.sh > /dev/null 2>&1<br>　-----------------------------------</div></p><h4>ffmpeg設定</h4><p>トラコン機能を使う為にffmpegのインストールを行います。<div class="command"># yum install --enablerepo=atrpms faad2 faad2-devel faac faac-devel lame lame-devel xvidcore xvidcore-devel<br># cd foltia_tool<br># tar zxvf ffmpeg-20050714.tar.gz<br># cd ffmpeg<br># make clean<br># ./configure --enable-mp3lame --enable-gpl --enable-ffplay --enable-a52 --enable-xvid --enable-faac --enable-faad --enable-amr_nb --enable-amr_wb --enable-pthreads<br># make<br># make install</div></p><h4>vfr4psp.sh編集</h4><p>faacをrpmでインストールしたため、パスの変更を行います。<div class="command">$ vi ~/perl/transcode/vfr4psp.sh<br>　-------------------------------------------<br>　/usr/local/bin/faac<br>　　↓<br>　/usr/bin/faac<br>　-------------------------------------------</div></p><h4>mp4pspインストール</h4><p><div class="command"># cd foltia_tool<br># tar zxvf mp4psp-fol.tar.gz<br># cd mp4psp<br># cp mp4psp /usr/local/bin/</div></p><h4>スターライトブレーカー設定</h4><p>スターライトブレーカーを使用できるように必要なパッケージをインストールしていきます。<div class="command"># yum --enablerepo=atrpms install mplayer<br># yum install ImageMagick</div></p><h4>Tira-2設定</h4><p>通常のインストールだとエラーでコンパイルできないため、forceを加えてインストールします。<div class="command"># perl -MCPAN -e shell<br>　cpan> force install Device::SerialPort<br># chmod 666 /dev/ttyUSB0</div></p><h4>信号学習方法</h4><p><div class="command">$ perl /home/foltia/perl/irda/capture.pl hoge.dat<br><br>　-----------------------------------------<br>　Checking Tira...OK<br>　Switch to Timing Mode...OK<br>　Caputuring IR-CODE.<br>　Please Push Remote Button(10 times or more)<br>　-----------------------------------------<br><br>このメッセージ後にリモコンをTira-2に向けて、信号を送信して学習させる。<br><br>$ perl /home/foltia/perl/irda/transfer.pl 1.dat</div>実際、Tira-2から信号を送信して、チューナーを操作できるか確認する。<br>以下、全数字ボタンの信号を登録する。1.dat,2.dat,3.dat,4.dat,5.dat,6.dat,7.dat,8.dat,9.dat,0.dat,X.dat<br><div class="command">$ vi /home/foltia/perl/foltia_conf1.pl<br>　-----------------------------------------<br>　$haveirdaunit = 1;<br>　-----------------------------------------<br></div>Tira-2を使用する場合、1にする。</p><h4>データベース設定</h4><p>Tira-2を使う為にはデータベースの編集が必要になります。らくちんに編集を行う為に、phpPgAdminのインストールを行います<div class="command"># wget http://ftp.icdevgroup.org/phpPgAdmin/phpPgAdmin-4.0.1-1.noarch.rpm# rpm -ivh phpPgAdmin-4.0.1-1.noarch.rpm# /etc/init.d/httpd restart</div></p><h4>データベース操作</h4><p>設定したphpPgAdminへアクセスを行い、テレビ放送局ごとに設定をおこなっていきます。以下の作業はブラウザで行います。<br><br>ブラウザを使用し、以下のアドレスにアクセスします。<br>　アクセスURL：http://[foltia IP]/phpPgAdmin/<br>以下スクリーンショットにて説明<br></p></div></html>